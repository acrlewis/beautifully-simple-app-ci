# This is the CircleCI configuration for the react_native_app project, which
# unfortunately is forced to be in the root.

# We are using the react_native_app directory.
general:
  build_dir: react_native_app
  artifacts:
    - ./artifacts

# We use Node 6 baby.
machine:
  node:
    version: 6
  environment:
    REACT_NATIVE_APP_RELEASE_KEYSTORE_PASSWORD: p@ssw0rd 

# Setup Android tools and Yarn.
dependencies:
  pre:
    - echo y | android update sdk --no-ui --all --filter "tools"
    - echo y | android update sdk --no-ui --all --filter "build-tools-23.0.1"
  cache_directories:
    # Cache Android SDK depenendcies.
    - /usr/local/android-sdk-linux/tools
    - /usr/local/android-sdk-linux/build-tools/23.0.1
  override:
    - yarn

# Our tests are run by the makefile.
test:
  override:
    - make build
    - make test
